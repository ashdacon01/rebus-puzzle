<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"> <!-- Set character encoding to UTF-8 -->
<meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Make page responsive on mobile -->
<title>Rebus Puzzle - Slideshow</title> <!-- Page title -->
<link rel="stylesheet" href="style.css"> <!-- Link external CSS file -->
</head>
<body>

<!-- Canvas for particle effects / background animations -->
<canvas id="particleCanvas"></canvas>

<!-- Ready popup before starting the game -->
<div id="readyPopup" class="ready-popup">
    <div class="ready-dialog">
        <p>Are you ready to play?</p>
        <div style="display:flex; flex-direction:column; gap:15px;">
            <button id="startGameBtn">Start</button> <!-- Button to start the game -->
            <button id="quitReadyBtn" style="background:#5a1f1f;">Quit</button> <!-- Button to quit to categories -->
        </div>
    </div>
</div>

<!-- Main puzzle page wrapper -->
<div class="puzzle-page">
<div class="puzzle-wrapper">

    <!-- FULLSCREEN BUTTON -->
    <button id="fullscreenBtn">⛶</button> <!-- Button to toggle fullscreen mode -->

    <h1 id="puzzleTitle">Puzzle</h1> <!-- Display current puzzle category/title -->

    <!-- Puzzle image container -->
    <div class="puzzle-tile" style="position:relative;">
        <img id="puzzleImage" src="" alt="Rebus Image"> <!-- Placeholder for puzzle image -->
        <div class="power-led"></div> <!-- Visual effect LED -->
        <div class="tv-foot-left"></div> <!-- Visual decoration -->
        <div class="tv-foot-right"></div> <!-- Visual decoration -->

        <!-- SCORE BOX -->
        <div id="scoreBox" style="position:absolute; top:12px; right:12px; z-index:500; padding:6px 12px; font-size:1rem; border-radius:6px; border:2px solid #00000080; background:#1f2327; color:white;">
            Score: 0 <!-- Display current score -->
        </div>
    </div>

    <!-- Correct/Wrong buttons -->
    <div class="nav-buttons">
        <button id="correctBtn" class="correct-btn">✔Correct</button>
        <button id="wrongBtn" class="wrong-btn">✖Wrong</button>
    </div>

    <!-- Navigation buttons for next/previous image -->
    <div class="nav-buttons">
        <button id="prevImg" class="rounded-btn">⏮ Prev</button>
        <button id="nextImg" class="rounded-btn">Next ⏭</button>
    </div>

    <!-- Hint button and container -->
    <button id="hintBtn" class="rounded-btn">Show Hint</button>
    <div class="hint-container">
        <p id="hintText"></p> <!-- Display hint text -->
    </div>

    <!-- Popup to show answer or feedback -->
    <div id="result"></div>

    <!-- Bottom navigation buttons -->
    <div class="bottom-buttons">
        <button class="back-btn" onclick="transitionBack()">Back</button> <!-- Back to category -->
        <button class="quit-btn" onclick="quitGame()">Quit</button> <!-- Quit game -->
    </div>
</div>

<!-- Popup for showing answer or hints -->
<div id="answerPopup" class="medium-popup" style="display:none;"></div>

<!-- Popup for play more / end game -->
<div id="playMorePopup" class="ready-popup" style="display:none;">
    <div class="ready-dialog">
        <p>Do you want to play more?</p>
        <div style="display:flex; flex-direction:column; gap:15px;">
            <button onclick="window.location.href='categories.html'">Category</button> <!-- Go back to category selection -->
            <button onclick="window.location.href='index.html'" style="background:#5a1f1f;">Quit</button> <!-- Quit to main menu -->
        </div>
    </div>
</div>

<!-- External JS -->
<script src="script.js"></script>

<script>
// ================= PARTICLE EFFECTS =================
const canvas = document.getElementById("particleCanvas"); // Particle canvas element
const ctx = canvas.getContext("2d"); // Canvas drawing context
canvas.width = window.innerWidth; // Set canvas width
canvas.height = window.innerHeight; // Set canvas height
const particles = []; // Array to store particles

// Initialize 120 particle objects
for(let i=0;i<120;i++){
    particles.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: 1+Math.random()*3, d: Math.random()*1 });
}

// Function to draw and animate particles
function drawParticles(){
    ctx.clearRect(0,0,canvas.width,canvas.height); // Clear canvas
    ctx.fillStyle = "rgba(255,255,255,0.3)"; // Particle color
    particles.forEach(p=>{
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.r,0,Math.PI*2,true); // Draw circle
        ctx.fill();
        p.y += 0.2 + p.d; // Move particle down
        if(p.y > canvas.height) p.y = 0; // Reset if below canvas
    });
    requestAnimationFrame(drawParticles); // Loop animation
}
drawParticles(); // Start particle animation

// ================= GET QUERY PARAM =================
function getQueryParam(param) {
    return new URLSearchParams(window.location.search).get(param); // Retrieve URL query parameter
}

// ================= QUIT / BACK =================
function quitGame() {
    if(document.querySelector(".quit-popup")) return; // Prevent multiple popups
    const box = document.createElement("div"); // Create popup container
    box.className = "quit-popup";
    box.innerHTML = `<div class="quit-dialog">
        <p>Are you sure you want to quit?</p>
        <div class="quit-buttons">
            <button id="yesQuit">Yes</button>
            <button id="noQuit">No</button>
        </div>
    </div>`;
    document.body.appendChild(box); // Add to DOM
    document.getElementById("yesQuit").onclick = () => { window.location.href="categories.html"; }; // Yes handler
    document.getElementById("noQuit").onclick = () => box.remove(); // No handler
}

function transitionBack() {
    window.location.href="categories.html"; // Navigate back to categories
}

// ================= READY POPUP =================
document.addEventListener("DOMContentLoaded",()=>{
    const readyPopup = document.getElementById("readyPopup"); // Ready popup element
    const startBtn = document.getElementById("startGameBtn"); // Start button
    const quitReadyBtn = document.getElementById("quitReadyBtn"); // Quit button
    const puzzlePage = document.querySelector(".puzzle-page"); // Puzzle page container

    startBtn.addEventListener("click",()=>{
        readyPopup.style.display = "none"; // Hide ready popup
        puzzlePage.classList.add("show"); // Show puzzle page
        initGame(); // Initialize game logic
    });

    quitReadyBtn.addEventListener("click", ()=>{ window.location.href = "categories.html"; }); // Quit handler
});

// ================= FULLSCREEN BUTTON LOGIC =================
const fsBtn = document.getElementById("fullscreenBtn"); // Fullscreen button
fsBtn.addEventListener("click", () => {
    if (!document.fullscreenElement) { // Enter fullscreen
        document.documentElement.requestFullscreen().catch(err=>console.warn(err));
    } else { // Exit fullscreen
        document.exitFullscreen();
    }
});

// Hide fullscreen button when in fullscreen mode
document.addEventListener("fullscreenchange", () => {
    fsBtn.style.display = document.fullscreenElement ? "none" : "block";
});

// ================= CONFETTI =================
function triggerConfetti(){
    const canvas = document.createElement("canvas"); // Create confetti canvas
    canvas.id = "confettiCanvas";
    canvas.style.position="absolute";
    canvas.style.top=0; canvas.style.left=0;
    canvas.style.width="100%"; canvas.style.height="100%";
    canvas.style.pointerEvents="none";
    canvas.style.zIndex=10;
    document.body.appendChild(canvas);
    const ctx = canvas.getContext("2d");
    const pieces=[];

    // Generate 150 confetti pieces
    for(let i=0;i<150;i++){ 
        pieces.push({ x: Math.random()*canvas.clientWidth, y: Math.random()*-50, size:5+Math.random()*8, speed:2+Math.random()*4 });
    }

    function update(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        pieces.forEach(p=>{
            p.y+=p.speed; // Move confetti down
            ctx.fillStyle=`hsl(${Math.random()*360},100%,50%)`; // Random color
            ctx.fillRect(p.x,p.y,p.size,p.size); // Draw confetti piece
        });
        requestAnimationFrame(update); // Loop animation
    }

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    update(); // Start animation
    setTimeout(()=>canvas.remove(),2500); // Remove after 2.5 seconds
}

// ================= INIT GAME =================
function initGame(){
    const category = getQueryParam("category") || "Brand Logos"; // Get category from URL
    document.getElementById("puzzleTitle").textContent = category; // Update title

    // Puzzle data sets
    const puzzleSets = {
                "Brand Logos": [
            { img:"images/brand_apple.png", answer:"Apple", hint:"A fruit and a tech company" },
            { img:"images/brand_disneyland.png", answer:"Disneyland", hint:"A famous theme park" },
            { img:"images/brand_fedex.png", answer:"FedEx", hint:"Famous delivery service" },
            { img:"images/brand_firefox.png", answer:"Firefox", hint:"A web browser with a fox" },
            { img:"images/brand_nike.png", answer:"Nike", hint:"Just do it" },
            { img:"images/brand_oreo.png", answer:"Oreo", hint:"Famous sandwich cookie" },
            { img:"images/brand_python.png", answer:"Python", hint:"A programming language or a snake" },
            { img:"images/brand_sprite.png", answer:"Sprite", hint:"A lemon-lime soft drink" },
            { img:"images/brand_starbucks.png", answer:"Starbucks", hint:"Coffee chain with a mermaid" },
            { img:"images/brand_twitter.png", answer:"Twitter", hint:"Social media with birds" },
            { img:"images/brand_facebook.png", answer:"Facebook", hint:"Blue social networking platform" },
            { img:"images/brand_lego.png", answer:"Lego", hint:"Plastic building bricks" },
            { img:"images/brand_paypal.png", answer:"PayPal", hint:"Online payment service" },
            { img:"images/brand_pepsi.png", answer:"Pepsi", hint:"Fizzy drink competitor of Coke" },
            { img:"images/brand_pinterest.png", answer:"Pinterest", hint:"Platform for saving ideas visually" },
            { img:"images/brand_redbull.png", answer:"RedBull", hint:"Energy drink with wings" },
            { img:"images/brand_samsung.png", answer:"Samsung", hint:"Electronics brand from Korea" },
            { img:"images/brand_shell.png", answer:"Shell", hint:"Oil company with a shell logo" },
            { img:"images/brand_snapchat.png", answer:"Snapchat", hint:"Social media with disappearing messages" },
            { img:"images/brand_subway.png", answer:"Subway", hint:"Sandwich fast food chain" },
            { img:"images/brand_fujifilm.png", answer:"Fujifilm", hint:"Camera and photography brand" },
            { img:"images/brand_rolex.png", answer:"Rolex", hint:"Luxury watch brand" },
            { img:"images/brand_intel.png", answer:"Intel", hint:"Computer processor maker" },
            { img:"images/brand_cornetto.png", answer:"Cornetto", hint:"Ice cream cone brand" },
            { img:"images/brand_drpepper.png", answer:"Dr Pepper", hint:"Soft drink with unique flavor" },
            { img:"images/brand_lamborgini.png", answer:"Lamborghini", hint:"Luxury Italian sports car" },
            { img:"images/brand_microsoft.png", answer:"Microsoft", hint:"Software company behind Windows" },
            { img:"images/brand_lipton.png", answer:"Lipton", hint:"Popular tea brand" },
            { img:"images/brand_mitsubishi.png", answer:"Mitsubishi", hint:"Japanese car and electronics company" },
            { img:"images/brand_hermes.png", answer:"Hermès", hint:"Luxury fashion brand" }
],

        "Movies": [
            { img:"images/ghost_rider.png", answer:"Ghost Rider", hint:"Marvel hero with a flaming skull" },
            { img:"images/bee_movie.png", answer:"Bee Movie", hint:"Animated film about an insect" },
            { img:"images/lion_king.png", answer:"Lion King", hint:"Disney animated classic in Africa" },
            { img:"images/spider_man.png", answer:"Spider Man", hint:"Hero with webs and a mask" },
            { img:"images/ant_man.png", answer:"Ant Man", hint:"Marvel hero who shrinks" },
            { img:"images/king_of_speech.png", answer:"King Of Speech", hint:"Movie about delivering speeches" },
            { img:"images/car_2.png", answer:"Car 2", hint:"Animated movie featuring vehicles" },
            { img:"images/girl_in_the_next_door.png", answer:"Girl In The Next Door", hint:"Title includes a girl and location" },
            { img:"images/rocket_man.png", answer:"Rocket Man", hint:"Biopic about a famous musician" },
            { img:"images/ice_man.png", answer:"Ice Man", hint:"Movie with 'man' in the title" },
            { img:"images/ghost_call.png", answer:"Ghost Call", hint:"Involves a spectral phone call" },
            { img:"images/back_to_future.png", answer:"Back To Future", hint:"Time travel classic" },
            { img:"images/karate_kid.png", answer:"Karate Kid", hint:"A young martial artist" },
            { img:"images/a_beautiful_mind.png", answer:"A Beautiful Mind", hint:"Movie about a mathematician" },
            { img:"images/social_web.png", answer:"Social Web", hint:"About online social connections" },
            { img:"images/she_is_gone.png", answer:"She Is Gone", hint:"Title suggests disappearance" },
            { img:"images/iniside_out.png", answer:"Iniside Out", hint:"Animated film about emotions" },
            { img:"images/no_county_for_oldman.png", answer:"No County For Oldman", hint:"Thriller movie title" },
            { img:"images/parasite.png", answer:"Parasite", hint:"Oscar-winning Korean thriller" },
            { img:"images/blade_runner.png", answer:"Blade Runner", hint:"Sci-fi detective film" },
            { img:"images/pirate_adventure.png", answer:"Pirate Adventure", hint:"Swashbuckling at sea" },
            { img:"images/she's_reading_part_2.png", answer:"She's Reading Part 2", hint:"Sequel title about reading" },
            { img:"images/7_king_speech.png", answer:"7 King Speech", hint:"Number and speech in the title" },
            { img:"images/rocketman_to_star.png", answer:"Rocketman To Star", hint:"Journey of a famous musician" },
            { img:"images/charlie_chocolate_factory.png", answer:"Charlie Chocolate Factory", hint:"Classic story about candy" },
            { img:"images/seven_ghost_in_the_house.png", answer:"Seven Ghost In The House", hint:"Haunted house movie" },
            { img:"images/eye_love_alien.png", answer:"Eye Love Alien", hint:"Wordplay involving eyesight" },
            { img:"images/3_alien_in_the_space.png", answer:"3 Alien In The Space", hint:"Sci-fi with aliens" },
            { img:"images/eye_love_small.png", answer:"Eye Love Small", hint:"Title plays on vision" },
            { img:"images/now_you_see_me.png", answer:"Now You See Me", hint:"Magic and heists" }
        ],

        "Idioms": [
            { img:"images/walking_on_eggshells.png", answer:"Walking on Eggshells", hint:"Being very cautious" },
            { img:"images/a_bright_idea.png", answer:"A Bright Idea", hint:"A clever thought" },
            { img:"images/butter_someone_up.png", answer:"Butter Someone Up", hint:"Flatter someone" },
            { img:"images/breadwinner.png", answer:"Breadwinner", hint:"Main income earner" },
            { img:"images/time_to_sleep.png", answer:"Time to Sleep", hint:"When it's bedtime" },
            { img:"images/brainstorm.png", answer:"Brainstorm", hint:"Generate ideas quickly" },
            { img:"images/belief.png", answer:"Belief", hint:"Conviction or trust" },
            { img:"images/firehouse.png", answer:"Firehouse", hint:"Where firefighters work" },
            { img:"images/icebox.png", answer:"Icebox", hint:"Old term for refrigerator" },
            { img:"images/follow_your_heart.png", answer:"Follow Your Heart", hint:"Do what you feel is right" },
            { img:"images/elephant_in_the_room.png", answer:"Elephant in the Room", hint:"An obvious problem ignored" },
            { img:"images/it's_raining_cats_and_dogs.png", answer:"It's Raining Cats and Dogs", hint:"Heavy rainfall" },
            { img:"images/don't_let_the_bedbugs_bite.png", answer:"Don't Let the Bedbugs Bite", hint:"Good night saying" },
            { img:"images/break_the_ice.png", answer:"Break the Ice", hint:"Start a conversation" },
            { img:"images/hit_the_hay.png", answer:"Hit the Hay", hint:"Go to sleep" },
            { img:"images/time_heals_all_wounds.png", answer:"Time Heals All Wounds", hint:"Emotional recovery" },
            { img:"images/playing_with_fire.png", answer:"Playing with Fire", hint:"Taking risks" },
            { img:"images/apple_of_my_eye.png", answer:"Apple of My Eye", hint:"Someone very precious" },
            { img:"images/think_outside_the_box.png", answer:"Think Outside the Box", hint:"Be creative" },
            { img:"images/knock_on_wood.png", answer:"Knock on Wood", hint:"Avoid bad luck" },
            { img:"images/world_without_end.png", answer:"World Without End", hint:"Eternal or infinite" },
            { img:"images/running_out_of_time.png", answer:"Running Out of Time", hint:"Limited time left" },
            { img:"images/hotter_than_the_bed.png", answer:"Hotter Than the Bed", hint:"Very warm" },
            { img:"images/irrelevant.png", answer:"Irrelevant", hint:"Not important" },
            { img:"images/cancel_the_plan.png", answer:"Cancel the Plan", hint:"Stop what was scheduled" },
            { img:"images/a_quick_word.png", answer:"A Quick Word", hint:"Brief conversation" },
            { img:"images/think_twice.png", answer:"Think Twice", hint:"Consider carefully" },
            { img:"images/mismatch.png", answer:"Mismatch", hint:"Not a proper fit" },
            { img:"images/twisted_reflection.png", answer:"Twisted Reflection", hint:"Distorted image" },
            { img:"images/speechless.png", answer:"Speechless", hint:"Lost for words" }
        ],

        "Animals": [
            { img: "images/bee.png", answer: "Bee", hint:"Makes honey" },
            { img: "images/bird.png", answer: "Bird", hint:"Has feathers and wings" },
            { img: "images/monkey.png", answer: "Monkey", hint:"Climbs trees" },
            { img: "images/dog.png", answer: "Dog", hint:"Man's best friend" },
            { img: "images/cat.png", answer: "Cat", hint:"Loves to purr" },
            { img: "images/pig.png", answer: "Pig", hint:"Pink farm animal" },
            { img: "images/rabbit.png", answer: "Rabbit", hint:"Has long ears and hops" },
            { img: "images/king_cobra.png", answer: "King Cobra", hint:"Venomous snake" },
            { img: "images/cow.png", answer: "Cow", hint:"Gives milk" },
            { img: "images/butterfly.png", answer: "Butterfly", hint:"Insect with colorful wings" },
            { img: "images/electric_eel.png", answer: "Electric Eel", hint:"Generates electricity" },
            { img: "images/two_legs.png", answer: "Two Legs", hint:"Number of legs humans stand on" },
            { img: "images/panda_bear.png", answer: "Panda Bear", hint:"Black and white bamboo eater" },
            { img: "images/poisonous_snake.png", answer: "Poisonous Snakes", hint:"Dangerous reptiles" },
            { img: "images/eagle.png", answer: "Eagle", hint:"Bird of prey" },
            { img: "images/love_birds.png", answer: "Love Birds", hint:"Small colorful parrots" },
            { img: "images/goat.png", answer: "Goat", hint:"Has horns and bleats" },
            { img: "images/mammals.png", answer: "Mammals", hint:"Animals that feed milk" },
            { img: "images/reptiles.png", answer: "Reptiles", hint:"Cold-blooded animals" },
            { img: "images/insects.png", answer: "Insects", hint:"Six-legged creatures" }
        ],

        "Sports": [
            { img: "images/marathon.png", answer: "Marathon", hint:"Long-distance running" },
            { img: "images/soccer.png", answer: "Soccer", hint:"Played with a round ball on a field" },
            { img: "images/basketball.png", answer: "Basketball", hint:"Throw a ball into a hoop" },
            { img: "images/tennis.png", answer: "Tennis", hint:"Played with rackets and a net" },
            { img: "images/swimming.png", answer: "Swimming", hint:"Moving in water" },
            { img: "images/boxing.png", answer: "Boxing", hint:"Fighting with gloves" },
            { img: "images/golf.png", answer: "Golf", hint:"Hit a ball into a hole" },
            { img: "images/ice_hockey.png", answer: "Ice Hockey", hint:"Played on ice with sticks" },
            { img: "images/archery.png", answer: "Archery", hint:"Shoot arrows at targets" },
            { img: "images/rock_climbing.png", answer: "Rock Climbing", hint:"Climbing steep surfaces" },
            { img: "images/downhill_skiing.png", answer: "Downhill Skiing", hint:"Snow sport going fast down slopes" },
            { img: "images/fishing.png", answer: "Fishing", hint:"Catching fish in water" },
            { img: "images/longboard_surfing.png", answer: "Longboard Surfing", hint:"Riding waves on a long board" },
            { img: "images/100_meter_sprint.png", answer: "100 Meter Sprint", hint:"Short-distance race" },
            { img: "images/weightlifting.png", answer: "Weightlifting", hint:"Lifting heavy weights" },
            { img: "images/road_cycling.png", answer: "Road Cycling", hint:"Bicycle racing on roads" },
            { img: "images/fencing.png", answer: "Fencing", hint:"Sword fighting sport" },
            { img: "images/water_volleyball.png", answer: "Water Volleyball", hint:"Played in swimming pool" },
            { img: "images/gymnastics.png", answer: "Gymnastics", hint:"Physical exercises and routines" },
            { img: "images/hurdles.png", answer: "Hurdles", hint:"Race with barriers" },
            { img: "images/ice_curling.png", answer: "Ice Curling", hint:"Sliding stones on ice" },
            { img: "images/track_relay.png", answer: "Track Relay", hint:"Team running event" },
            { img: "images/long_jump.png", answer: "Long Jump", hint:"Jumping far distance" },
            { img: "images/equestrian_target.png", answer: "Equestrian Target", hint:"Horse riding with targets" },
            { img: "images/kickboxing.png", answer: "Kickboxing", hint:"Martial arts with punches and kicks" },
            { img: "images/karate.png", answer: "Karate", hint:"Japanese martial art" },
            { img: "images/judo.png", answer: "Judo", hint:"Throwing martial art" },
            { img: "images/sepak_takraw.png", answer: "Sepak Takraw", hint:"Kick a ball over a net using feet" },
            { img: "images/cricket.png", answer: "Cricket", hint:"Bat-and-ball sport" },
            { img: "images/sumo_wrestling.png", answer: "Sumo Wrestling", hint:"Japanese wrestling with large competitors" }
        ],

        "Food": [
            { img:"images/margarita.png", answer:"Margarita", hint:"A cocktail with lime" },
            { img:"images/pineapple.png", answer:"Pineapple", hint:"Tropical fruit with spikes" },
            { img:"images/sunny_side_up.png", answer:"Sunny Side Up", hint:"Fried egg style" },
            { img:"images/mac_and_cheese.png", answer:"Mac and Cheese", hint:"Pasta with cheese" },
            { img:"images/onion_ring.png", answer:"Onion Ring", hint:"Deep fried vegetable ring" },
            { img:"images/bánh_mì.png", answer:"Bánh Mì", hint:"Vietnamese sandwich" },
            { img:"images/grilled_steak.png", answer:"Grilled Steak", hint:"Cooked beef on a grill" },
            { img:"images/popcorn.png", answer:"Popcorn", hint:"Popped corn kernels" },
            { img:"images/pad_thai.png", answer:"Pad Thai", hint:"Thai stir-fried noodles" },
            { img:"images/lemonade.png", answer:"Lemonade", hint:"Lemon drink" },
            { img:"images/pesto_pasta.png", answer:"Pesto Pasta", hint:"Noodles with basil sauce" },
            { img:"images/hot_chocolate.png", answer:"Hot Chocolate", hint:"Warm cocoa drink" },
            { img:"images/corn_flakes.png", answer:"Corn Flakes", hint:"Breakfast cereal" },
            { img:"images/chicken_salad.png", answer:"Chicken Salad", hint:"Mixed greens with poultry" },
            { img:"images/spring_rolls.png", answer:"Spring Rolls", hint:"Wrapped vegetable appetizer" },
            { img:"images/banana_split.png", answer:"Banana Split", hint:"Dessert with ice cream and banana" },
            { img:"images/tequila_sunrise.png", answer:"Tequila Sunrise", hint:"Cocktail with orange and grenadine" },
            { img:"images/grape_wine.png", answer:"Grape Wine", hint:"Fermented fruit drink" },
            { img:"images/french_toast.png", answer:"French Toast", hint:"Bread dipped in egg and fried" },
            { img:"images/hotpot.png", answer:"Hotpot", hint:"Communal cooking in broth" },
            { img:"images/s'mores.png", answer:"S'mores", hint:"Chocolate and marshmallow snack" },
            { img:"images/iced_coffee.png", answer:"Iced Coffee", hint:"Cold caffeinated drink" },
            { img:"images/bread.png", answer:"Bread", hint:"Staple baked food" },
            { img:"images/mushroom-soup.png", answer:"Mushroom Soup", hint:"Creamy fungi-based soup" },
            { img:"images/rice.png", answer:"Rice", hint:"Common grain staple" },
            { img:"images/fortune_cookie.png", answer:"Fortune Cookie", hint:"Sweet cookie with a message" },
            { img:"images/hawaiian_pizza.png", answer:"Hawaiian Pizza", hint:"Topped with ham and pineapple" }
        ]
    };

    const imagesArray = puzzleSets[category]; // Get puzzles for category
    let currentIndex = 0; // Current puzzle index
    let score = 0; // Player score

    // Elements for game interaction
    const puzzleImage = document.getElementById("puzzleImage");
    const hintBtn = document.getElementById("hintBtn");
    const answerPopup = document.getElementById("answerPopup");
    const scoreBox = document.getElementById("scoreBox");

    const nextBtn = document.getElementById("nextImg");
    const prevBtn = document.getElementById("prevImg");
    const correctBtn = document.getElementById("correctBtn");
    const wrongBtn = document.getElementById("wrongBtn");

    // Audio feedback
    const correctSound = new Audio("sounds/correct.mp3");
    const wrongSound = new Audio("sounds/wrong.mp3");
    const finishSound = new Audio("sounds/finishes.mp3");

    // Show a puzzle image based on index
    function showImage(index){
        if(index<0) index=0;
        if(index>=imagesArray.length) index=imagesArray.length-1;
        currentIndex=index;
        puzzleImage.src = imagesArray[currentIndex].img;
        hintBtn.disabled=false;
        nextBtn.disabled = true;
    }

    nextBtn.addEventListener("click",()=>showImage(currentIndex+1)); // Next puzzle
    prevBtn.addEventListener("click",()=>showImage(currentIndex-1)); // Previous puzzle

    // Update score display
    function updateScoreDisplay() {
        scoreBox.textContent = `${score}/${currentIndex + 1}`;
    }

    // Correct button click
    correctBtn.addEventListener("click", () => {
        score++; // Increment score
        updateScoreDisplay(); // Update display
        nextBtn.disabled = false; // Enable next
        answerPopup.style.display = "flex";
        answerPopup.textContent = `Correct! Answer: ${imagesArray[currentIndex].answer}`;
        correctSound.play();

        if(currentIndex === imagesArray.length - 1){
            triggerConfetti(); // Celebrate
            finishSound.play();
            answerPopup.style.display = "flex";
            answerPopup.textContent = `Final Score:\n${score}/${imagesArray.length}`;
            setTimeout(()=>{ 
                answerPopup.style.display = "none"; 
                document.getElementById("playMorePopup").style.display="flex"; 
            }, 15000); // Show final score for 15 sec
        }
    });

    // Wrong button click
    wrongBtn.addEventListener("click", () => {
        nextBtn.disabled = false; // Enable next
        updateScoreDisplay(); // Update score
        answerPopup.style.display = "flex";
        answerPopup.textContent = `✖ Wrong!\nTry again.`;
        wrongSound.play();
    });

    // Hint button
    hintBtn.addEventListener("click", () => {
        hintBtn.disabled = true; // Disable hint button
        nextBtn.disabled = false; // Enable next
        const hintText = imagesArray[currentIndex].hint || "No hint available"; // Get hint
        answerPopup.style.display = "flex";
        answerPopup.textContent = `Hint: ${hintText}`; // Show hint
    });

    // Hide answer popup on click
    answerPopup.addEventListener("click",()=>{ answerPopup.style.display="none"; });

    showImage(0); // Show first image
}
</script>

</body>
</html>
